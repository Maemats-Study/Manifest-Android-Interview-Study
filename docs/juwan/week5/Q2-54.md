Q)54. Jetpack Viewmodel 에 대해 설명해 주세요.

jetpack Viewmodel 은 생명주기를 인식하는 방식으로 UI 관련 데이터를 저장하고 관리하도록 설계된 아드로이드 아키텍쳐 컴포넌트의 핵심 구성 요소입니다. 화면 회전과 같은 구성 변경 시에도 데이터가 유지되도록 보장하면서 UI 로직과 비즈니스 로직을 분리하여 개발자가 견고하고 유지 관리 가능한 앱을 만드는 데 도움을 줍니다.

ViewModel의 주요 목표는 구성 변경 중에 UI 관련 데이터를 보존하는 것 입니다. 예를 들어, 사용자가 기기를 회전하면 Activity 또는 Fragment가 소멸되고 다시 생성되자만 ViewModel 은 파괴되지 않아 데이터가 그래도 유지되도록 보장합니다.

```kotlin
 data class DiceUiState(
val firstDieValue: Int? = null,
val secondDieValue: Int? = null,
val numberOfRolls: Int = 0,
)

class DiceRollViewModel : ViewModel() {
// 화면 UI 상태 노출
private val _uiState = MutableStateFlow(DiceUiState())
val uiState: StateFlow<DiceUiState> = _uiState.asStateFlow()
// 비즈니스 로직 처리
fun rollDice() {
_uiState.update { currentState‑>
currentState.copy(
firstDieValue = Random.nextInt(from = 1, until = 7),
secondDieValue = Random.nextInt(from = 1, until = 7),
numberOfRolls = currentState.numberOfRolls + 1,
)
}
}
```

ViewModel 의 특징 

1. 생명주기 인식(Lifecycle Awareness): ViewModel은 Activity 또
는 Fragment의 생명주기에 범위가 지정됩니다. 사용자가 화면에서
벗어나는 등 연관된 UI 컴포넌트가 더 이상 사용되지 않을 때
자동으로 소멸됩니다.
2. 구성 변경 간 지속성(Persistence Across Configuration
Changes): 구성 변경 중에 소멸되고 다시 생성되는 Activity
또는 Fragment와 달리 ViewModel은 상태를 유지하여 데이터 손실
을 방지하고 데이터의 반복적인 재로드를 피합니다.
3. 관심사 분리(Separation of Concerns): ViewModel은 UI 관련
로직과 비즈니스 로직을 분리하여 더깔끔하고 유지관리하기쉬운
코드를 설계하는 데 도움이 됩니다. UI 레이어는 ViewModel에서
업데이트를 관찰하므로 반응형 프로그래밍 원칙을 구현하기가 더
쉬워집니다.

ViewModel 생성 및 사용
Jetpack activity‑ktx 라이브러리97에서 제공하는 ComponentActivity의
확장함수인 viewModels() 델리게이트를 사용하여 ViewModel을 보다 쉽게
생성할 수 있습니다. 해당 확장 함수는 ViewModel 생성을 단순화합니
다.

ViewModel 인스턴스는 ViewModel 인스턴스의 생명주기를 관리하
기 위한 메커니즘 역할을 하는 ViewModelStoreOwner에 스코프가 지정
됩니다. ViewModelStoreOwner는 Activity, Fragment, Navigation 그
래프, Navigation 그래프 내 대상 또는 개발자가 정의한 커스텀
ViewModelStoreOwner가 될 수도 있습니다. Jetpack 라이브러리는 다양
한 사용 사례를 충족하기 위해 ViewModel 스코프를 지정하는 다양한
옵션을 제공합니다. 포괄적인 개요는 아래 일러스트에서 제공하는
ViewModel API 치트 시트98를 참조할 수 있습니다.

![image.png](attachment:86b51ed7-fb04-400d-875b-1dba44cc2863:image.png)

⇒ Jetpack ViewModel 은 구성 변경  시에도 원활하게 유지되도록 보장하면서 UI 상태 관련 데이터를 저장하고 관리하도록 설계된 Jetpack의 핵심 구성 요소입니다. 안드로이드 컴포넌트의 생명주기를 인식하고 MVVM 아키텍쳐 패턴과 효과적으로 통합되어 화면 회전과 같은 이벤트 중에 데이터를 유지함으로써 상태 관리를 단순화하고 전반적인 개발 경험을 향상시킵니다.

![image.png](attachment:9823d9f7-4290-4d10-bb8a-72f8fb829fc0:image.png)