# Q 37) Canvas 란 무엇이며 어떻게 활용하나요?

**Canvas는 커스텀 드로잉을 위한 핵심 구성 요소입니다. 화면이나 Bitmap과 같은 다른 드로잉이 가능한 표면에 직접 그래픽을 렌더링하기 위한 인터페이스를 제공합니다. Canvas는 개발자에게 드로잉 프로세스에 대한 완전한 제어를 제공하여 커스텀 뷰, 애니메이션 및 시각 효과를 만드는 데 다방면으로 활용됩니다**

### 1. Canvas 작동 방식

---

Canvas 클래스는 도형, 텍스트, 이미지 및 기타 콘텐츠를 그릴 수 있는 2D 드로잉 표면을 나타냅니다. 그려진 콘텐츠가 어떻게 보여야 하는지(색상, 스타일, 스트로크 너비 등) 정의하는 Paint 클래스와 긴밀하게 상호 작용합니다. 커스텀 View의 onDraw() 메서드를 재정의하면 Canvas 객체가 전달되어 무엇을 그릴지 정의할 수 있습니다

---

### 2. Canvas의 일반적인 작업

---

Canvas는 다음과 같은 다양한 드로잉 작업을 허용합니다.
**• 도형(Shapes)**: drawCircle(), drawRect(), drawLine()과 같은 메서드를 사용하여 원, 사각형, 선과 같은 도형을 그릴 수 있습니다.
• **텍스트(Text)**: drawText() 메서드는 지정된 좌표와 모양으로 텍스트를 렌더링합니다.
• **이미지(Images):** drawBitmap()을 사용하여 이미지를 렌더링합니다.
• **커스텀 패스(Custom Paths**): Path 객체와 drawPath()를 결합하여복잡한 모양을 그릴 수 있습니다.

---

### 3. 변환 (Transformations)

---

Canvas는 크기 조절(scaling), 회전(rotating), 이동(translating)과 같은변환을지원합니다.이러한작업은캔버스의좌표계를수정하여 복잡한 장면을 더 쉽게 그릴 수 있도록 합니다

- 이동(Translation): canvas.translate(dx, dy)를 사용하여 캔버스 원점을 새 위치로 이동**합**니다.
- 크기 조절(Scaling): canvas.scale(sx, sy)를 사용하여 드로잉 크기를 배율로 조절합니다.
- 회전(Rotation): canvas.rotate(degrees)를 사용하여 지정된 각도로 캔버스를 회전합니다.

**⇒ 이러한 변환은 메서드를 호출 할 때마다 누적되어 적용되며, 이후의 모든 드로잉 작업에 영향을 미칩니다**

---

### Android compose 에서의 canvas

[Compose의 그래픽  |  Jetpack Compose  |  Android Developers](https://developer.android.com/develop/ui/compose/graphics/draw/overview?hl=ko)

### **Jetpack Compose Canvas API**

---

Jetpack Compose 를 사용하게 되면서 Canvas 를 더욱 쉽게 사용할 수 있게 되었습니다 

기존의 Native Canvas API 를 사용할 때에는 View 를 상속 받아 onLayout, onDraw 등의 라이프사이클과 상태를 고려하면서 작업을 진행했어야 했지만, 이제는 Jetpack Compose 를 이용해 View 를 상속받을 필요 없이 굉장히 쉬운 방법으로 UI 를 그릴 수 있습니다. Jetpack Compose Canvas 또한 Composable Function 으로 나타내고 있고, Compose 에서 UI 를 추가하는 방식처럼 Canvas 도 동일한 방식으로 배치할 수 있습니다.

> Canvas는 Android에서 Custom UI를 간편하게 그리기 위한 다양한 API를 제공해준다. Canvas에서 제공해주는 API를 사용하면 도형, 텍스트를 그릴 수 있고, 애니메이션 또한 만들 수 있다.또한 Canvas는 그려야 할 도형들이 많을 때, Composable 여러개를 사용해 그리는 것에 비해 자원을 효율적으로 사용한다. 이 때문에 만약 화면이 여러 도형으로 구성되어있고, 도형의 상태(크기, 색상 등)을 계속해서 변경시켜야 하는 작업에서는 Canvas를 사용하는 것이 훨씬 리소스를 적게 사용한다.
> 

```kotlin
@Composable
fun Icon() {
    Canvas(
        modifier = Modifier
            .size(100.dp)
    ) {
      //draw shapes here
    }
}
```

```kotlin
@Preview(showBackground = true)
@Composable
fun CanvasExample() {
    Canvas(
        modifier = Modifier.size(300.dp),
        onDraw = {
            drawRect(
                color = Color.Blue,
                topLeft = Offset(100.dp.toPx(), 100.dp.toPx()),
                size = Size(100.dp.toPx(), 100.dp.toPx())
            )
        }
    )
}
```

Canvas 에서 사용되는 Paint 역시 기존 Native Canvas API 로 다루게 될 때 성능 이슈가 종종 발생하곤 했는데, 이 문제 역시 Jetpack Compose API 를 이용해 쉽게 제어가 가능하게 되었습니다. 덕분에 캔버스 안에 그릴 도형이나 선의 위치를 미세하게 배치할 수 있고 다양하게 스타일링이 가능해지게 되었답니다

Compose 로 Canvas 위에 객체를 그릴 때도 동일하게 drawArc 함수를 이용해 호를 그릴 수 있으며, 필요한 파라미터도 기존 Native Canvas 와 동일합니다. 하지만 기존 Native Canvas API 를 사용했을 때와 비교할 때, Compose가 더 쉽고 빠르게 구현할 수 있다는 것을 체험할 수 있었습니다. 머리에서 어떻게 그릴지 그려놓은 상태라면, 쉽게 코드로 옮길 수 있는 구조를 제공하는 느낌이었습니다.

[Custom Canvas Animations in Jetpack Compose ✨](https://medium.com/androiddevelopers/custom-canvas-animations-in-jetpack-compose-e7767e349339)

⇒ 이거는 Jetpack compose animation api와 canvas 를 활용할 때 원하는 객체를 커스터마이징 하기 편할 것  같아서, 한 번 가져와 봤습니다.