# 안드로이드 애플리케이션의 프로세스란?

<aside>

### 프로세스(process)

: 애플리케이션이 실행되는 환경

- 각 안드로이드 앱은 다른 앱과 격리된 자체 프로게스에서 단일 실행 스레드로 작동하여 시스템 보안, 메모리 관리 및 내결함성(fault tolerance)을 보장
- 안드로이드 프로세스는 리눅스 커널을 사용하여 운영 체제에 의해 관리되며 엄격한 생명주기 규칙을 따름
- 기본적으로 동일한 애플리케이션의 모든 컴포넌트는 메인 스레드라고 하는 동일한 프로셋 및 스레드에서 실행됨
</aside>

## 안드로이드에서 프로세스 작동 방식

- 안드로이드 애플리케이션이 시작되면 운영 체제는 리눅스 fork() 시스템 함수를 호출하여 해당 앱을 위한 새 프로세스를 생성함
- 각 프로세스는 Dalvik 또는 ART(안드로이드 런타임) 가상 머신의 고유 인스턴스에서 실행되어 안전하고 독립적인 실행을 보장
- 안드로이드는 각 프로세스에 고유한 리눅스 사용자 ID(UID)를 할당하여 권한 제어 및 파일 시스템 격리를 포함한 엄격한 보안 경계를 적용

## 애플리케이션 컴포넌트와 프로세스 연결

- 기본적으로 안드로이드 애플리케이션의 모든 컴포넌트는 동일한 프로세스 내에서 실행되며, 대부분의 애플리케이션은 이 표준을 따름
- 하지만 개발자는 AndroidManifest.xml 파일의 android:process 속성을 사용하여 프로세스 할당을 커스텀할 수 있음
    - 해당 속성은 <activity>, <service>, <receiver>, <provider>와 같은 컴포넌트에 적용될 수 있어 컴포넌트가 별도의 프로세스에서 실행되거나 선택적으로 프로세스를 공유할 수 있도록 함
    - <application> 요소도 이 속성을 지원하여 모든 컴포넌트의 기본 프로세스를 정의
    
    ```xml
    <service
    		android:name=".MyService"
    		android:process=":remote" />
    ```
    
    → 이 예제에서 MySerivce 서비스는 :remote라는 별도의 프로세스에서 실행되어 독립적인 작동과 향상된 내결함성을 가능하게 함
    
- 다른 애플리케이션의 컴포넌트가 동일한 리눅스 사용자 ID를 가지고 동일한 인증서로 서명된 경우 동일한 프로세스를 공유할 수 있음
- 안드로이드는 시스템 리소스 요구에 따라 프로세스를 동적으로 관리하며, 필요할 때 우선순위가 낮은 프로세스를 종료
    - 더 이상 보이지 않는 Activity를 호스팅하는 프로세스는 보이는 컴포넌트를 호스팅하는 프로세스보다 종료될 가능성이 더 높음
- 안드로이드 시스템은 연관된 컴포넌트가 작업을 수행해야 할 때 프로세스슬 다시 시작하여 최적의 시스템 성능과 사용자 경험을 보장

## 프로세스와 앱 생명주기

안드로이드는 시스템 메모리와 앱의 현재 상태를 기반으로 프로세스 및 앱 생명주기를 관리하며, 엄격한 우선순위 계층을 따름

1. 포그라운드 프로세스 (Foregroud Process)
    - 사용자와 활발하게 상호 작용하며 실행 중인 프로세스
    - 가장 높은 우선순위의 프로세스이며 거의 종료되지 않음
2. 보이는 프로세스 (Visible Process)
    - 사용자에게 보이지만 활발하게 상호작용하지 않는 프로세스
    - ex. 다이얼로그 뒤의 Activity
3. 서비스 프로세스 (Service Process)
    - 데이터 동기화나 음악 재생과 같은 작업을 수행하는 백그라운드 Service를 실행하는 프로세스
4. 캐시된 프로세스 (Cached Process)
    - 더 빠른 재실행을 위해 메모리에 유지되는 유휴 프로세스
    - 캐시된 프로세스는 우선순위가 가장 낮으며 메모리가 부족할 때 가장 먼저 종료됨

## 보안 및 권한

- 각 안드로이드 프로세스는 리눅스 보안 모델을 사용하여 샌드박스 처리 → 엄격한 권한 기반 접근 제어 시행
- 안드로이드 권한 시스템을 통해 명시적으로 권한이 부여되지 않는 한 애플리케이션이 다른 프로세스의 데이터에 접근할 수 없도록 보장
- 이 보안 모델은 안드로이드의 멀티태스킹 환경의 기본이며 시스템 안정성과 데이터 개인 정보 보호를 모두 지원