# 안드로이드 런타임(ART), Dalvik, Dex 컴파일러란?

- 안드로이드 애플리케이션은 기기에서 실행되기 위해 고유한 런타임 환경과 컴파일 프로세스에 의존
- 안드로이드 런타임(ART), Dalvik, Dex 컴파일러는 이 프로세스에서 중요한 역할을 하며, 앱이 성능, 메모리 효율성 및 안드로이드 기기와의 호환성을 위해 최적화되도록 보장

## 안드로이드 런타임 (ART)

<aside>

안드로이드 4.4 (Kitkat)에서 도입되어 안드로이드 5.0 (Lollipop)부터 디폴트로 사용되는 관리형 런타임 환경

→ 안드로이드 앱 실행을 위한 런타임으로 Dalvik을 대체하며 여러 사항들을 개선

</aside>

- Ahead-of-Time (AOT) 컴파일을 사용하여 애플리케이션을 컴파일
- 앱 설치 중에 바이트코드를 기계 코드로 변환

→ 런타임 시 Just-in-Time (JIT) 컴파일의 필요성을 없애 앱 시작 시간을 단축하고 실행 중 CPU 사용량을 줄임

### ART의 주요 특징

- 개선된 성능
    - AOT 컴파일 → 최적화된 기계 코드를 생성하여 런타임 오버헤드를 줄임
- 가비지 컬렉션
    - ART는 더 나은 메모리 관리를 위해 개선된 가비지 컬렉션 기술을 도입
- 디버깅 및 프로파일링 지원
    - 개발자를 위해 상세한 스택 트레이스 및 메모리 사용량 분석과 같은 향상된 도구를 제공

## Dalvik

<aside>

ART 이전에 안드로이드에서 사용된 런타임

- 가상 머신 환경에서 애플리케이션을 실행하도록 설계
- 제한된 메모리와 처리 능력을 위해 최적화
</aside>

- Just-in-Time (JIT) 컴파일을 사용하여 런타임에 바이트 코드를 기계 코드로 변환

→ 앱 설치에 필요한 시간을 줄이지만, 즉석 컴파일로 인해 런타임 오버헤드가 증가

### Dalvik의 주요 특징

- 컴팩트한 바이트코드
    - Dalvik은 낮은 메모리 사용량과 빠른 실행을 위해 최적화된 .dex (Dalvik Executable) 파일을 사용
- 레지스터 기반 VM
    - Dalvik은 스택 기반(Java Virtual Machine과 같음)이 아닌 레지스터 기반이므로 명령어 효율성이 향상됨

→ 느린 앱 시작 시간과 높은 CPU 사용량과 같은 한계로 인해 최신 안드로이드 버전에서는 ART로 대체됨

### Dex 컴파일러

<aside>

- Java/Kotlin 컴파일러에서 생성된 Java 바이트코드를 .dex (Dalvik Executabel) 파일로 변환
- .dex 파일은 컴팩트하며 Dalvik 및 ART 런타임 환경에 최적화됨
</aside>

- 안드로이드 애플리케이션이 기기에서 효율적으로 실행되도록 하는 데 중요한 역할을 함

### Dex 컴파일러의 주요 특징

- 멀티덱스(Multi-dex) 지원
    - 64K 메서드 제한을 초과하는 애플리케이션의 경우 Dex 컴파일러는 바이트코드를 여러 .dex 파일로 분할하는 것을 지원
- 바이트코드 최적화
    - 컴파일러는 안드로이드 기기에서 더 나은 메모리 사용량과 실행 성능을 위해 바이트코드를 최적화

Dex 컴파일 프로세스는 안드로이드 빌드 시스템에 통합되어 있으며, 앱 개발의 빌드 단계 중에 발생

### Dalvik → ART 전환

- 안드로이드 런타임 환경을 개선
- ART의 AOT 컴파일, 개선된 가비지 컬렉션, 프로파일링 기능 → 더 나은 개발자 및 사용자 경험 제공
- Dalvik 용으로 설계된 앱: .dex 파일을 사용 → ART와 완벽하게 호환됨 (원활한 마이그레이션 보장)