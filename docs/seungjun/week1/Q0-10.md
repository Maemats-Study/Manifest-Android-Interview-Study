# Q) 10. BroadcastReceiver란 무엇인가요?
BroadcastReceiver 는 안드로이드 운영체제 전체의 브로드캐스트 메시지나
앱 특정 브로드캐스트를 수신하고 응답할 수 있도록 하는 컴포넌트입니다.

일반적으로 시스템이나 다른 애플리케이션에 의해 트리거되어 배터리 상태 변경, 네트워크 연결 업데이트
또는 앱 내에서 전송된 커스텀 Intent 와 같은 다양한 이벤트를 알립니다.

### BroadcastReceiver의 목적
BroadcastReceiver는 Activity 나 Service 의 생명주기에 직접적으로 연결되지 않을
수 있는 이벤트를 처리하는데 사용됩니다. 백그라운드에서 계속 실행되지 않고도 변경 사항에 반응할 수 있도록 하는
수신기 역할을 하여 리소스를 절약합니다.

### 브로드캐스트 유형
1. System Broadcast:<br/>
안드로이드 운영 체제에서 배터리 잔량이나 시간대 업데이트, 네트워크 연결 변경과 같은 시스템 이벤트를
앱에 알리기 위해 보냅니다.
2. Custom Broadcast:<br/>
애플리케이션에서 앱 내부 또는 앱간에 특정 정보나 이벤트를 전달하기 위해 보냅니다.

### 커스텀 BroadcastReceiver 등록
`BroadcastReceiver` 를 상속받고 `onReceive` 메서드를 재정의 하여 생성할 수 있습니다.
```kotlin
class MyBroadcastReceiver: BroadcastReceiver() {
    override fun onRecevie(context: Context, intent: Intent) {
        val action = intent.action
        if (action == Intent.ACTION_BATTERY_LOW) {
            // 배터리 부족 이벤트 처리
            Log.d("MyBroadcastReceiver", "Battery is low!")
        }
    }
}
```
1. 매니페스트 파일을 통한 정적 등록<br/>
앱이 실행 중이지 않을 때도 처리해야하는 이벤트에 사용합니다.

    ```xml
    <!‑‑ Android 8.0 (API 26) 이상에서는 대부분의 암시적 브로드캐스트 수신 제한 ‑‑>
    <receiver android:name=".MyBroadcastReceiver" 
              android:exported="false">
        <intent‑filter>
            <action android:name="android.intent.action.BATTERY_LOW" />
        </intent‑filter>
    </receiver>
    ```

2. 코드를 통한 동적 등록<br/>
앱이 활성 상태이거나 특정 상태일 때만 처리해야하는 이벤트시 사용 ex) Wi-Fi 상태변경 이벤트 수신
    ```kotlin
    val receiver = MyBroadcastReceiver()
    val intentFilter = IntentFilter(Intent.ACTION_BATTERY_LOW)
    // Android Tiramisu (API 33) 이상에서는 RECEIVER_EXPORTED 또는 RECEIVER_NOT_EXPORTED 플래그 필요
    val flags = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
        Context.RECEIVER_NOT_EXPORTED
    } else {
        0 // 플래그 없음
    }
    registerReceiver(receiver, intentFilter, flags)
    
    // Activity나 컴포넌트가 소멸될 때 등록 해제 필수
    override fun onDestroy() {
        unregisterReceiver(receiver)
        super.onDestroy()
    }
    ```
    동적 등록시 메모리 누수 방지를 위해 `unregisterReceiver`를 사용해 리시버 등록을 해제합니다.

### BroadcastReceiver 사용 사례
- 네트워크 연결 변경 모니터링. 
- SMS 또는 통화 이벤트에 응답. 
- 충전 상태와 같은 시스템 이벤트에 대한 UI 업데이트. 
- 커스텀 브로드캐스트로 작업 또는 알람 예약.

<details>
    <summary>암시적 브로드캐스트(implicit broadcast)</summary>
안드로이드에서 암시적 브로드캐스트(implicit broadcast)는 BroadcastReceiver를 사용하여 시스템에서 발생하는 특정 이벤트를 수신하는 것을 의미합니다. 암시적 브로드캐스트는 명시적(explicit) 브로드캐스트와는 달리 특정한 액션(action)을 지정하지 않고, 그냥 인텐트(intent) 객체를 사용하여 전체 시스템에 브로드캐스트됩니다.

하지만, 안드로이드 시스템에서 모든 암시적 브로드캐스트를 수신하는 것은 안전하지 않을 수 있습니다. 왜냐하면 다른 애플리케이션에서 브로드캐스트를 발생시키면 해당 앱에서 수신할 수 있기 때문입니다. 따라서 Android 8.0(Oreo)부터는 암시적 브로드캐스트의 사용을 제한하고, 보안상 이유로 일부 브로드캐스트는 명시적으로 전달해야 합니다.

따라서, 안드로이드 앱을 개발할 때, 가능한한 명시적 브로드캐스트를 사용하도록 권장됩니다. 또한, 안드로이드 8.0 이상에서는 암시적 브로드캐스트 예외를 방지하기 위해 명시적으로 수신자(receiver)를 등록해야 합니다.
</details>

### 실전 질문
Q) 브로드캐스트의 유형에는 어떤 것이 있으며, 기능 및 사용 측면에서
시스템 브로드캐스트와 커스텀 브로드캐스트는 어떤 차이가 있나요?

시스템 브로드캐스트
- 안드로이드 OS 나 시스템 앱이 발생시키는 이벤트
- 예:
  - BOOT_COMPLETED (부팅 완료)
  - BATTERY_LOW (배터리 부족)
  - CONNECTIVITY_CHANGE (네트워크 상태 변경)
  
커스텀 브로드캐스트
- 사용자가 직접 정의하여 전송하는 이벤트
- 예:
    - 앱 내부 컴포넌트 간 데이터 전달
    - 특정 동작 완료 알림 