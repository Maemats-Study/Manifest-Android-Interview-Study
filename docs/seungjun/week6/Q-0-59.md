# Q) 59. 장기적으로 실행되는 백그라운드 작업을 어떻게 관리하나요?

### WorkManager
앱이 닫히거나 기기 재부팅 후에도 실행되어야 하는 작업의 경우 사용합니다.
조건부 작업에 주로 사용합니다.

- 특정 시점에 진행되어야 할 작업의 예약(시간, 네트워크 연결 여부, 충전 여부, 캐시 삭제)
- 여러가지 작업의 체이닝(다운로드 > 알림 발송)
- 단 한번만 실행되어야 하는 작업(초기 설정)
- 업로드, 다운로드 진행상황을 보여주는 UI

### Service
음악 재생이나 위치 추적과 같이 지속적이고 오랜 실행이 필요한 작업에는 서비스를 사용합니다.

### JobScheduler
작업이 기기 전체 작업과 관련되고 특정 조건이 필요한 경우 JobScheduler 를 사용할 수 있습니다.
WorkManager 는 내부적으로 JobScheduler 를 활용하기에 일반적인 상황에서는 WorkManager 를 사용하는 것이 좋습니다.

### 실전 질문
Q) 안드로이드 앱에서 백엔드 서버로부터 대용량 파일(수백 MB)을 다운로드하는 기능을 구현해야 합니다.
다운로드는 앱이 닫혀도 계속 되어야 하며, 성능 및 네트워크 조건 측면에서 효율적이어야 합니다.
WorkManager, Foreground Service, JobScheduler 중 어떤 것을 선택하여 구현하시겠나요?

WorkManager를 사용해서 OneTimeWorkRequest로 다운로드 작업을 등록하고,
네트워크 타입을 UNMETERED(Wi-Fi), 충전 상태 등의 Constraints를 설정하겠습니다.
다운로드 중에는 Worker에서 setForegroundAsync()를 통해 Foreground Notification을 띄워
시스템 제약을 피하고, 앱이 닫혀도 다운로드가 계속되도록 하겠습니다. 실패 시에는 WorkManager의 backoff 정책을 사용해 재시도하고,
Range 요청(HTTP Range 헤더)을 이용해 중간부터 이어받기(resume) 도 지원하겠습니다.