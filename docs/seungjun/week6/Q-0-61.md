# Q) 61. 원격 데이터를 가져오기 위해 네트워크 요청을 어떻게 처리하며, 효율성과 신뢰성을 위해 어떤 라이브러리나 기술을 사용하나요?

> 용어 정리
> Retrofit: 선언적 인터페이스를 제공하여 API 상화 작용을 단순화하는 라이브러리
> Okhttp: 기본적인 HTTP 클라이언트 역할을 하여 연결 폴링, 캐싱 및 효율적인 통신 제공

### OAuth 토큰 갱신
Autenticator 와 Interceptor 를 제공

1. OkHttp Authenticator
토큰 만료 및 갱신 시나리오를 처리하도록 따로 설계
서버가 401 Unauthorized 상태 코드 응답시 Authenticator 를 호출해
업데이트된 인증 자격 증명이 포함된 새 요청을 제공
2. TokenInterceptor
response 401 응답 확인 -> 토큰 만료인 경우, 해당 토큰을 새로고침하는 로직 추가

일반적으로는 Authenicator 를 사용한 방식을 권장한다.
간단히 OAuth 토큰을 갱신하는 것이 목적이라면 Authenticator 를 통해 처리하는 것이 적합하다.
Interceptor 는 커스텀 토큰 관리를 위한 세부적인 처리에 유용하다고 한다.

### Retrofit CallAdaptor
개발자가 Retrofit API 메서드의 반환 타입을 사용자 정의할 수 있도록 하는 추상화 API
동기식 또는 비동기식으로 실행될 수 있는 HTTP 요청을 나타내는 Call<T> 객체를 반환하지만,
CallAdapter 를 사용하면 LiveData, Flow, RxJava 또는 커스텀 타입과 같은 다른 타입으로 변환 할 수 있다.

기본적으로 Retrofit 에는 Call<T> 객체를 직접 반환하는 CallAdapter 가 포함되어 있다.
다른 타입을 원하면 적절한 라이브러리를 사용하거나, 커스텀 CallAdapter를 작성해야한다.

#### Coroutine CallAdapter
Retrofit API 인터페이스에서 suspend 함수를 사용할 수 있다.
Call<T> 타입을 반환하는 대신 어댑터는 해당 메서드를 실행하면서 실제 네트워크 호출 결과를 반환하거나 오류에 대한
예외를 던지도록 한다.

Kotlin 사용시 Retrofit 에 내장되 어 있기 때문에 Kotlin Coroutines Adapter 를 바로 사용할 수 있다. 
단순히 인터펭스에 정의할 때 suspend 를 작성해주면 Coroutine 방식이 사용된다.

### 실전 질문
Q) 앱에서 동시에 여러 API 요청을 수행하고 UI를 업데이트하기 전에
결과를 결합해야 한다고 가정해 봅시다. Retrofit과 코루틴을 사용하여 이를 효율적으로 구현하려면 어떻게 해야 하나요?


Q) API 응답 실패 시 어떻게 처리하고, 재시도 메커니즘은 어떻게 구현하나요?