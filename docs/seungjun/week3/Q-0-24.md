# Q) 24. 예외(exceptions)를 어떻게 추적하나요?

### 로깅

#### Logcat
로그를 보고 예외를 추적하는 기본적인 도구

#### Timber
Timber 는 Jake Wharton 아 만든 오픈소스 로깅 라이브러리 입니다.

- 로그 메시지가 생성된 클래스 기반으로 자동으로 로그 태그를 생성합니다.
- Debug 모드에서만 로그를 나타낼 수 있어 안전합니다.

**사용법**<br/>
아래와 같은 설정을 통해 디버그 모드에서만 로그를 남길 수 있습니다.
```kotlin
// 사용자 정의 Application 클래스에서 
class MyTimber : Application() { 
    override fun onCreate() { 
        super.onCreate()
        if (BuildConfig.DEBUG) Timber.Forest.plant(Timber.DebugTree())
     } 
} 
```

### 예외처리

#### try-catch
일반적으로 자바와 동일한 방식으로 예외를 처리하고 앱의 클래시를 방지할 수 있습니다.

#### runCatching
코틀린에서는 예외처리 방식으로 runCatching 도 존재합니다.

[코틀린 예외처리 정리](https://branched-umbra-716.notion.site/Kotlin-2934e863b28280bca729ecd9b544416f?source=copy_link)

### 전역 예외 핸들러 사용
`Thread.setDefaultUncatughtExceptionHanlder` 를 사용하여
전역 예외 핸들러를 설정하면 앱 전체에서 처리되지 않는 예외를 포착하는데 도움됩니다.

```kotlin
class MyApplication : Application() {
    override fun onCreate() {
        super.onCreate()
        val defaultHandler = Thread.getDefaultUncaughtExceptionHandler()
        Thread.setDefaultUncaughtExceptionHandler { thread, exception ‑>
            Log.e("GlobalHandler", "Uncaught exception in thread ${thread.name}: " +
                    "${exception.message}", exception)
            // 예외 세부 정보 저장 또는 서드 파티 솔루션으로 전송 (Crashlytics 등)
            // FirebaseCrashlytics.getInstance().recordException(exception)
            // 기존 핸들러 호출 (선택 사항, 시스템 기본 크래시 동작 유지)
            defaultHandler?.uncaughtException(thread, exception) 
        }
    }
}
```
디버그 또는 QA 빌드에서만 예외를 추적할수 있습니다.<br/>
*더 알아보기

### Firebase Crashlytics 사용하기
프로덕션 환경에서 예외를 추적하는 도구<br/>
처리되지 않은 예외를 자동으로 기록하고 스택 트레이스, 기기 상태 및 사용자 정보와
함께 crash 보고서를 제공합니다.

<details>

<summary>그밖에 방법들</summary>

### Breakpoints 를 이용한 디버깅
지겁 코드 실행시 breakpoint 를 기점으로 일시 중지하고 앱 상태를 검사합니다.
디버그 모드를 활성화하고 변수, 메서드 호출 및 예외 스택 트레이스를 탐색할 수 있습니다.

### Bug Report 캡처
버그 리포트를 캡처하면, 기기 로그, 스택 트레이스 및
시스템 정보를 수집하여 문제를 진단하고 수정하는 데 도움이 됩니다.

1. 개발자 옵션: 개발자 옵션을 활성화하고, 설정 > 개발자 옵션 >
   버그 신고로 이동하여 버그 신고 유형을 선택하고 생성된 보고서를
   공유합니다.
2. Android Emulato에서 버그 신고 캡처: 확장 컨트롤을 열고 버그
   신고를 선택한 다음 관련 세부 정보와 함께 보고서를 저장합니다.
3. ADB (Android Debug Bridge)를 사용하여 버그 신고 캡처: 터미
   널에서 adb bugreport /path/to/save/bugreport를 실행하거나, adb ‑s
   <device_serial_number> bugreport로 특정 기기를 지정합니다.


생성된 ZIP 파일에는 디버깅에 필수적인 dumpsys, dumpstate, logcat과
같은 로그가 포함되어 있습니다. 버그 리포트는 접근될 때까지 저장되며
성능 및 크래시 진단을 위해 분석에 사용될 수 있습니다.
</details>

### 실전 질문
Q) Logcat을 사용하여 개발 환경에서 예외를 디버깅하는 것과 Firebase Crashlytics와 같은 도구를
사용하여 프로덕션 환경에서 예외를 처리 하는 것의 차이점은 무엇인가요?
또한, Logcat과 같은 로컬 환경에서 추적된 예외랑 프로덕션에서 추적된 예외를 각각 어떻게 해결하시나요?

Logcat은 개발 중 실시간으로 예외를 확인·수정하는 로컬 디버깅 도구이고,
Crashlytics는 사용자 기기에서 발생한 예외를 수집·분석하는 프로덕션 모니터링 도구입니다.
로컬 예외는 즉시 재현·코드 수정으로 해결하고, 프로덕션 예외는 Crashlytics 리포트를 기반으로
패턴 분석 → 원인 파악 → 패치 배포로 해결합니다.