# Q) 16. 태스크(tasks)와 백 스택(back stack)이란 무엇인가요?

태스크(Task) 는 사용자가 특정 작업을 수행하기 위해 상호작용하는 Activity 의 집합
태스크는 백 스택 구조로 관리되고, LIFO 구조로 이루어져 있습니다.

### 태스크 (Task)
일반적으로 런처나 Intent 를 통해 Activity 가 실행될 때 시작됩니다.
태스크는 연관된 Activity 가 소멸 될 때까지 활성 상태를 유지합니다.

### 백 스택 (Back Stack)
백 스택은 태스크 내 Activity 기록을 유지합니다.

태스크와 백 스택은 Activity launch mode 와 플래그(intent flags) 의
영향을 받습니다. 개발자는 Activity 가 어떻게 시작되고 다른 Activity 와 
어떻게 상호 작용하는지 정의할 수 있습니다.

### 런치 모드 (Launch Modes)
런치모드는 Activity 가 어떻게 인스턴화되고 백스택에서 처리되는지를 결정합니다.

1. standard:<br/>
기본 런치 모드로, 액티비티를 계속 새로 생성하여 스택에 쌓습니다.
2. singleTop:<br/>
Activity 가 백 스택의 최상단에 있는 경우 새로운 인스턴스를 사용하지 않습니다.
`onNewIntent()` 로 Intent 를 처리합니다.
3. singleTask:<br/>
Activity 의 인스턴스가 하나만 존재합니다. 스택에 액티비티가 있으면 맨 앞으로 가져오고,
`onNewIntent()` 가 호출 됩니다. 보통 앱 진입 역할을 Activity 에 유용합니다.
4. singleInstance:<br/>
Activity 가 단 하나만 존재하는 별도의 태스크를 생성합니다. (알람, 전화 앱 과 같은 기능시 사용)

### 인텐트 플래그 (Intent Flags)
Activity의 중복 문제나 흐름을 제어하고 싶을 때 Intent Flag 를 사용합니다.
AndroidManifest 에서 액티비티 태그 안에 flag를 설정하거나
소스 코드에서 intent 에 `addflag()` 를 사용하여 제어할 수 있습니다.

- FLAG_ACTIVITY_NEW_TASK:<br/>
새로운 태스크를 생성하여 그곳에 액티비티를 위치시킵니다.
만약 이미 해당 액티비티를 위한 태스크가 존재한다면, 그 태스크를 포그라운드로 가져옵니다.
- FLAG_ACTIVITY_CLEAR_TOP:<br/>
호출하려는 액티비티가 이미 스택에 존재할 경우, 그 액티비티 위에 쌓여 있던 모든 액티비티를 제거하고
해당 액티비티를 최상단으로 가져옵니다.
- FLAG_ACTIVITY_SINGLE_TOP:<br/>
호출하려는 액티비티가 이미 스택의 맨 위에 존재한다면,
새로운 인스턴스를 만들지 않고 기존 액티비티를 재사용합니다. (onNewIntent() 콜백이 호출됨)
- FLAG_ACTIVITY_NO_HISTORY:<br/>
Activity 가 백 스택에 추가되는 것을 방지하여 종료 후에 유지되지 않도록 합니다. (스플래쉬 화면)



### 실전 질문
Q) singleTask와 singleInstance의 차이점은 무엇이며, 각각 어떤
시나리오에서 사용해야 하나요?
singleTask 는 태스크에 오직 하나의 인스턴스만 존재하도록 재사용하는 개념으로
앱의 메인, 홈 화면과 같이 앱의 시작되는 화면에서 사용합니다.<br/>

singleInstance 는 오직 자기 자신만 태스크에 존재하는 것으로
별도의 태스크를 생성해서 독린적인 태스크를 가집니다.
주로, 전화 수신, 알림 화면과 같이 독립적으로 실행되어야 하는 기능에서 사용합니다.


Q) Activity 런치 모드에는 각각 어떤 타입이 존재하며, 태스크 및
백 스택 동작에 어떤 영향을 미치나요?

액티비티 런치 모드에는 standard, singleTop, singleTask, singleInstance 네 가지 타입이 있습니다.
이들은 액티비티를 새로 만들지, 기존 것을 재사용할지,
또는 별도의 태스크에서 관리할지를 결정하여 백 스택 동작을 제어합니다.