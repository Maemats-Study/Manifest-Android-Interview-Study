# Q) 21. SaveableStateHolder에 대해서 설명해 주세요. 그리고 어떤 시나리오에서 유용한가요?

컴포저블이 네비게이션 또는 화면 전환과 같이 컴포지션에서 일시적으로 제거되더라도 상태를 유지하도록 보장하는 방법

`SaveableStateHolder` 는 고유 키와 연결된 컴포저블의 상태를 관리하고 보존하기 위해 `rememberSavable` 과 함께 작동하는 **Compose Runtime API**

네비게이션에서 `SaveableStateHolder` 사용 예제

네비게이션 시스템을 직접 구현하는 코드

```kotlin
@Composable
fun <T: Any> Navigation(
    currentScreen: T, // 현재 표시할 화면을 나타내는 키
    modifier: Modifier = Modifier,
    content: @Composable (T) -> Unit // 현재 화면 키에 해당하는 컴포저블 컨텐츠
) {
    // SaveableStateHolder 인스턴스를 rememberSaveable 로 생성 유지
    val saveableStateHolder = rememberSaveableStateHolder()
    
    Box(modifier) {
        // AnimatedContent를 사용하여 화면 전환 애니메이션 적용 (선택 사항)
        AnimatedContent(
            targetState = currentScreen,
            transitionSpec = {
                fadeIn(animationSpec = tween(300)) 
                togetherWith fadeOut(animationSpec = tween(300)
            },
            label =
            "NavigationAnimation"
    ) { targetScreen ‑>
		    // SaveableStateProvider로 현재 화면 콘텐츠를 래핑하여 상태 저장/복원
		    // key는 targetScreen으로, 화면별로 상태를 구분하여 저장
		    saveableStateHolder.SaveableStateProvider(key = targetScreen) {
		        content(targetScreen) // 실제 화면 콘텐츠 렌더링
        }
    }
}

@Composable
fun SaveableStateHolderExample() {
    // 현재 화면 상태를 rememberSaveable로 관리 (구성 변경 시 유지)
    var screen by rememberSaveable { mutableStateOf("screen1") 
    
    Column {
        // 화면 전환 버튼
        Row(
            modifier = Modifier.fillMaxWidth(),
            horizontalArrangement = Arrangement.SpaceEvenly
        ) {
            Button(onClick = { screen = "screen1" }) { Text("Go to screen2") }
            Button(onClick = { screen = "screen2" }) { Text("Go to screen1") }
        }

        // SaveableStateHolder를 사용하는 Navigation 컴포저블 호출
        Navigation(screen, Modifier.fillMaxSize()) { currentScreen ‑>
            // 현재 화면 키에 따라 다른 화면 표시
            when (currentScreen) {
                "screen1" ‑> Screen1()
                "screen2" ‑> Screen2()
            }
        }
    }
}
```